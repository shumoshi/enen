<!DOCTYPE html>

<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‚ç‚ãƒæ¶ˆé˜²éšŠ ãƒ‘ãƒãƒ³ã‚³ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0f23, #1a1a2e, #16213e, #0f3460);
            color: #fff;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            animation: backgroundShift 10s ease-in-out infinite alternate;
        }

```
    @keyframes backgroundShift {
        0% { background-position: 0% 50%; }
        100% { background-position: 100% 50%; }
    }

    .container {
        max-width: 1000px;
        margin: 0 auto;
        background: rgba(0,0,0,0.4);
        border-radius: 20px;
        padding: 30px;
        border: 3px solid #ff6b35;
        box-shadow: 0 0 30px rgba(255, 107, 53, 0.3);
        backdrop-filter: blur(10px);
    }

    h1 {
        text-align: center;
        color: #ff6b35;
        font-size: 2.8em;
        margin-bottom: 30px;
        text-shadow: 3px 3px 6px rgba(0,0,0,0.7);
        background: linear-gradient(45deg, #ff6b35, #ff8c42, #ffa726);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .game-area {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 25px;
        margin-bottom: 30px;
    }

    .panel {
        background: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
        border: 2px solid rgba(255, 255, 255, 0.2);
        border-radius: 15px;
        padding: 20px;
        backdrop-filter: blur(10px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .panel:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
    }

    .status-panel {
        border-color: #ff6b35;
        background: linear-gradient(145deg, rgba(255, 107, 53, 0.15), rgba(255, 107, 53, 0.05));
    }

    .results-panel {
        border-color: #0096ff;
        background: linear-gradient(145deg, rgba(0, 150, 255, 0.15), rgba(0, 150, 255, 0.05));
    }

    .counter-panel {
        border-color: #00ff88;
        background: linear-gradient(145deg, rgba(0, 255, 136, 0.15), rgba(0, 255, 136, 0.05));
    }

    .panel h3 {
        text-align: center;
        margin-bottom: 20px;
        font-size: 1.3em;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }

    .stat-item {
        display: flex;
        justify-content: space-between;
        margin: 12px 0;
        padding: 12px 15px;
        background: rgba(255,255,255,0.08);
        border-radius: 8px;
        border-left: 4px solid rgba(255, 107, 53, 0.6);
        transition: all 0.3s ease;
    }

    .stat-item:hover {
        background: rgba(255,255,255,0.12);
        border-left-color: #ff6b35;
    }

    .stat-value {
        font-weight: bold;
        color: #fff;
    }

    .counter-item {
        text-align: center;
        padding: 15px;
        margin: 10px 0;
        background: rgba(0, 255, 136, 0.1);
        border-radius: 10px;
        border: 2px solid rgba(0, 255, 136, 0.3);
    }

    .counter-value {
        font-size: 2.2em;
        font-weight: bold;
        color: #00ff88;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }

    .counter-label {
        font-size: 0.9em;
        color: #ccc;
        margin-top: 5px;
    }

    .mode-indicator {
        text-align: center;
        font-size: 1.6em;
        font-weight: bold;
        padding: 18px;
        border-radius: 12px;
        margin: 15px 0;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
        transition: all 0.3s ease;
    }

    .mode-indicator:hover {
        transform: scale(1.05);
    }

    .mode-normal { 
        background: linear-gradient(45deg, #666, #999, #bbb); 
        animation: pulse 2s infinite;
    }
    .mode-charge { 
        background: linear-gradient(45deg, #ff6b35, #ff8c42, #ffa726); 
        animation: fireGlow 1.5s infinite;
    }
    .mode-breath { 
        background: linear-gradient(45deg, #ff0000, #ff6b35, #ff8c42); 
        animation: breathe 1s infinite;
    }
    .mode-rush { 
        background: linear-gradient(45deg, #0096ff, #00d4ff, #00ffff); 
        animation: rushPulse 0.8s infinite;
    }
    .mode-extra { 
        background: linear-gradient(45deg, #ffd700, #ffed4e, #fff176); 
        color: #000; 
        animation: goldGlitter 1.2s infinite;
    }

    @keyframes pulse {
        0%, 100% { opacity: 0.8; }
        50% { opacity: 1; }
    }

    @keyframes fireGlow {
        0%, 100% { box-shadow: 0 0 20px rgba(255, 107, 53, 0.5); }
        50% { box-shadow: 0 0 30px rgba(255, 107, 53, 0.8); }
    }

    @keyframes breathe {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
    }

    @keyframes rushPulse {
        0%, 100% { box-shadow: 0 0 15px rgba(0, 150, 255, 0.5); }
        50% { box-shadow: 0 0 25px rgba(0, 150, 255, 0.8); }
    }

    @keyframes goldGlitter {
        0%, 100% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.6); }
        50% { box-shadow: 0 0 35px rgba(255, 215, 0, 0.9); }
    }

    .controls {
        text-align: center;
        margin: 20px 0;
    }

    button {
        background: linear-gradient(45deg, #ff6b35, #ff8c42);
        color: white;
        border: none;
        padding: 15px 30px;
        font-size: 1.2em;
        border-radius: 25px;
        cursor: pointer;
        margin: 0 10px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
    }

    button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(255, 107, 53, 0.5);
    }

    button:disabled {
        background: #666;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
    }

    .log {
        background: rgba(0,0,0,0.5);
        border-radius: 10px;
        padding: 15px;
        height: 200px;
        overflow-y: auto;
        font-family: monospace;
        font-size: 0.9em;
        border: 1px solid #333;
    }

    .log-entry {
        margin: 5px 0;
        padding: 5px;
        border-radius: 3px;
    }

    .log-normal { background: rgba(255,255,255,0.1); }
    .log-hit { background: rgba(255, 107, 53, 0.3); }
    .log-rush { background: rgba(0, 150, 255, 0.3); }
    .log-extra { background: rgba(255, 215, 0, 0.3); color: #000; }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 20px;
    }

    .auto-controls {
        margin: 20px 0;
        text-align: center;
    }

    .auto-controls label {
        margin: 0 15px;
    }

    .rush-mode-display {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
        margin: 10px 0;
    }

    .rush-mode-item {
        text-align: center;
        padding: 10px;
        border-radius: 5px;
        font-size: 0.9em;
    }

    .white-mode { background: rgba(255,255,255,0.2); }
    .green-mode { background: rgba(0,255,0,0.2); }
    .blue-mode { background: rgba(0,150,255,0.2); }
</style>
```

</head>
<body>
    <div class="container">
        <h1>ğŸ”¥ ç‚ç‚ãƒæ¶ˆé˜²éšŠ ãƒ‘ãƒãƒ³ã‚³ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ ğŸ”¥</h1>

```
    <div class="game-area">
        <div class="status-panel">
            <h3>ğŸ“Š ç¾åœ¨ã®çŠ¶æ³</h3>
            <div class="mode-indicator" id="currentMode">é€šå¸¸ãƒ¢ãƒ¼ãƒ‰</div>
            
            <div class="stat-item">
                <span>ç·å›è»¢æ•°:</span>
                <span id="totalSpins">0</span>
            </div>
            <div class="stat-item">
                <span>ç·å‡ºç‰:</span>
                <span id="totalBalls">0ç™º</span>
            </div>
            <div class="stat-item">
                <span>å½“ãŸã‚Šå›æ•°:</span>
                <span id="hitCount">0å›</span>
            </div>
            <div class="stat-item">
                <span>ãƒ©ãƒƒã‚·ãƒ¥çªå…¥å›æ•°:</span>
                <span id="rushCount">0å›</span>
            </div>

            <div class="rush-mode-display" id="rushModeDisplay" style="display: none;">
                <div class="rush-mode-item white-mode">
                    <div>ç™½ãƒ¢ãƒ¼ãƒ‰</div>
                    <div>55%</div>
                </div>
                <div class="rush-mode-item green-mode">
                    <div>ç·‘ãƒ¢ãƒ¼ãƒ‰</div>
                    <div>25%</div>
                </div>
                <div class="rush-mode-item blue-mode">
                    <div>é’ãƒ¢ãƒ¼ãƒ‰</div>
                    <div>20%</div>
                </div>
            </div>
        </div>

        <div class="results-panel">
            <h3>ğŸ“ˆ ç¢ºç‡ãƒ»åæ”¯</h3>
            <div class="stat-item">
                <span>å›³æŸ„ç¢ºç‡:</span>
                <span>1/416.5</span>
            </div>
            <div class="stat-item">
                <span>ç‚ç‚ãƒãƒ£ãƒ¼ã‚¸:</span>
                <span>1/2186</span>
            </div>
            <div class="stat-item">
                <span>ãƒ©ãƒƒã‚·ãƒ¥ä¸­å½“ãŸã‚Š:</span>
                <span>1/2.0</span>
            </div>
            <div class="stat-item">
                <span>ãƒ©ãƒƒã‚·ãƒ¥çªå…¥æ™‚:</span>
                <span>é’ãƒ¢ãƒ¼ãƒ‰ç¢ºå®š</span>
            </div>
            <div class="stat-item">
                <span>ç¾åœ¨ã®åæ”¯:</span>
                <span id="balance">0ç™º</span>
            </div>
            <div class="stat-item">
                <span>å‡ºç‰ç‡:</span>
                <span id="payoutRate">--%</span>
            </div>
        </div>
    </div>

    <div class="controls">
        <button onclick="spinOnce()" id="spinButton">1å›è»¢</button>
        <button onclick="spin10()" id="spin10Button">10å›è»¢</button>
        <button onclick="spin100()" id="spin100Button">100å›è»¢</button>
        <button onclick="resetGame()">ãƒªã‚»ãƒƒãƒˆ</button>
    </div>

    <div class="auto-controls">
        <label>
            <input type="checkbox" id="autospin"> ã‚ªãƒ¼ãƒˆã‚¹ãƒ”ãƒ³
        </label>
        <label>
            é€Ÿåº¦: <select id="autoSpeed">
                <option value="10">è¶…é«˜é€Ÿ</option>
                <option value="100">é«˜é€Ÿ</option>
                <option value="300" selected>ä¸­é€Ÿ</option>
                <option value="500">ä½é€Ÿ</option>
            </select>
        </label>
    </div>

    <div class="log" id="gameLog"></div>
</div>

<script>
    // ã‚²ãƒ¼ãƒ çŠ¶æ…‹
    let gameState = {
        mode: 'normal', // normal, charge, breath, rush, extra
        totalSpins: 0,
        currentSpins: 0, // å½“ãŸã‚Šã‹ã‚‰ã®å›è»¢æ•°
        totalBalls: 0,
        hitCount: 0,
        rushCount: 0,
        rushMode: 'white', // white, green, blue
        extraStack: 0,
        isAutoSpin: false,
        autoSpinInterval: null,
        hitHistory: [] // å½“ãŸã‚Šæ™‚ã®å›è»¢æ•°å±¥æ­´
    };

    // ç¢ºç‡å®šæ•°
    const PROBABILITIES = {
        normalHit: 1/416.5,
        charge: 1/2186,
        breathSuccess: 0.5,
        chargeToBreath: 0.437,
        rushHit: 0.5,
        rushFall: 1/5.9,
        smallHit: 1/5.3,
        rushContinue: 0.73,
        rushToNormal: 0.5208,
        extraContinue: 0.5,
        extraAdd: 0.5
    };

    // ãƒ¢ãƒ¼ãƒ‰æŒ¯ã‚Šåˆ†ã‘
    const RUSH_MODE_DISTRIBUTION = {
        white: 0.55,
        green: 0.25,
        blue: 0.20
    };

    // å‡ºç‰æŒ¯ã‚Šåˆ†ã‘
    const PAYOUT_DISTRIBUTION = {
        white: { normal: 0.86, extra: 0.14 },
        green: { normal: 0.67, extra: 0.33 },
        blue: { normal: 0.50, extra: 0.50 }
    };

    function random() {
        return Math.random();
    }

    function spinOnce() {
        gameState.totalSpins++;
        gameState.currentSpins++;
        
        switch(gameState.mode) {
            case 'normal':
                handleNormalSpin();
                break;
            case 'charge':
                handleChargeSpin();
                break;
            case 'breath':
                handleBreathSpin();
                break;
            case 'rush':
                handleRushSpin();
                break;
            case 'extra':
                handleExtraSpin();
                break;
        }
        
        updateDisplay();
    }

    function handleNormalSpin() {
        const rand = random();
        
        if (rand < PROBABILITIES.normalHit) {
            // å›³æŸ„æƒã„ - å±¥æ­´ã«ç·å›è»¢æ•°ã‚’è¨˜éŒ²ã—ã¦ãƒªã‚»ãƒƒãƒˆ
            gameState.hitHistory.push({
                type: 'å›³æŸ„æƒã„',
                spins: gameState.totalSpins
            });
            gameState.totalSpins = 0;
            gameState.currentSpins = 0;
            gameState.hitCount++;
            const rushRand = random();
            
            if (rushRand < PROBABILITIES.rushToNormal) {
                // ãƒ©ãƒƒã‚·ãƒ¥ç›´è¡Œ
                gameState.totalBalls += 3000;
                gameState.mode = 'rush';
                gameState.rushCount++;
                gameState.rushMode = selectRushMode();
                addLog('ğŸŠ å›³æŸ„æƒã„ï¼ãƒ©ãƒƒã‚·ãƒ¥ç›´è¡Œï¼ 3000ç™ºç²å¾—ï¼', 'log-rush');
            } else {
                // é€šå¸¸å½“ãŸã‚Š
                gameState.totalBalls += 1500;
                addLog('â­ å›³æŸ„æƒã„ï¼é€šå¸¸å½“ãŸã‚Š 1500ç™ºç²å¾—', 'log-hit');
            }
            
            // å¤§å½“ãŸã‚Šæ™‚ã¯ã‚ªãƒ¼ãƒˆã‚¹ãƒ”ãƒ³åœæ­¢
            stopAutoSpinOnHit();
            
        } else if (rand < PROBABILITIES.normalHit + PROBABILITIES.charge) {
            // ç‚ç‚ãƒãƒ£ãƒ¼ã‚¸ - å±¥æ­´ã«ç·å›è»¢æ•°ã‚’è¨˜éŒ²ã—ã¦ãƒªã‚»ãƒƒãƒˆ
            gameState.hitHistory.push({
                type: 'ãƒãƒ£ãƒ¼ã‚¸',
                spins: gameState.totalSpins
            });
            gameState.totalSpins = 0;
            gameState.currentSpins = 0;
            gameState.mode = 'charge';
            gameState.totalBalls += 300;
            addLog('ğŸ”¥ ç‚ç‚ãƒãƒ£ãƒ¼ã‚¸çªå…¥ï¼ 300ç™ºç²å¾—', 'log-hit');
            
            if (random() < PROBABILITIES.chargeToBreath) {
                gameState.mode = 'breath';
                addLog('âš”ï¸ å‘½ã®å‘¼å¸ãƒãƒ£ãƒ¬ãƒ³ã‚¸çªå…¥ï¼', 'log-rush');
            }
            
            // ãƒãƒ£ãƒ¼ã‚¸æ™‚ã‚‚ã‚ªãƒ¼ãƒˆã‚¹ãƒ”ãƒ³åœæ­¢
            stopAutoSpinOnHit();
        }
    }

    function handleChargeSpin() {
        // ãƒãƒ£ãƒ¼ã‚¸çŠ¶æ…‹ã®å‡¦ç†ï¼ˆé€šå¸¸ã¯å³åº§ã«çµ‚äº†ï¼‰
        gameState.mode = 'normal';
    }

    function handleBreathSpin() {
        if (random() < PROBABILITIES.breathSuccess) {
            // æˆåŠŸ
            gameState.totalBalls += 1500;
            gameState.mode = 'rush';
            gameState.rushCount++;
            gameState.rushMode = selectRushMode();
            addLog('âœ¨ å‘½ã®å‘¼å¸ãƒãƒ£ãƒ¬ãƒ³ã‚¸æˆåŠŸï¼ãƒ©ãƒƒã‚·ãƒ¥çªå…¥ï¼ 1500ç™ºç²å¾—', 'log-rush');
            
            // ãƒ©ãƒƒã‚·ãƒ¥çªå…¥æ™‚ã‚‚ã‚ªãƒ¼ãƒˆã‚¹ãƒ”ãƒ³åœæ­¢
            stopAutoSpinOnHit();
        } else {
            // å¤±æ•—
            gameState.mode = 'normal';
            addLog('ğŸ’” å‘½ã®å‘¼å¸ãƒãƒ£ãƒ¬ãƒ³ã‚¸å¤±æ•—...', 'log-normal');
        }
    }

    function handleRushSpin() {
        const hitRand = random();
        
        if (hitRand < PROBABILITIES.rushHit) {
            // å½“ãŸã‚Š
            gameState.hitCount++;
            const modeData = PAYOUT_DISTRIBUTION[gameState.rushMode];
            const payoutRand = random();
            
            if (payoutRand < modeData.normal) {
                // é€šå¸¸å‡ºç‰ - ãƒ©ãƒƒã‚·ãƒ¥ç¶™ç¶š
                gameState.totalBalls += 1500;
                gameState.rushMode = selectRushModeAfterHit(); // æ¬¡å›ãƒ¢ãƒ¼ãƒ‰æŠ½é¸
                addLog(`ğŸ’ ãƒ©ãƒƒã‚·ãƒ¥ä¸­å½“ãŸã‚Šï¼(${gameState.rushMode}ãƒ¢ãƒ¼ãƒ‰ç¶™ç¶š) 1500ç™ºç²å¾—`, 'log-rush');
            } else {
                // ã‚¨ã‚¯ã‚¹ãƒˆãƒ©
                gameState.totalBalls += 4500;
                gameState.mode = 'extra';
                addLog(`ğŸŒŸ ã‚¨ã‚¯ã‚¹ãƒˆãƒ©çªå…¥ï¼ 4500ç™ºç²å¾—`, 'log-extra');
                
                // ã‚¨ã‚¯ã‚¹ãƒˆãƒ©çªå…¥æ™‚ã‚‚ã‚ªãƒ¼ãƒˆã‚¹ãƒ”ãƒ³åœæ­¢
                stopAutoSpinOnHit();
            }
        } else {
            // å½“ãŸã‚‰ãªã‹ã£ãŸå ´åˆã€è»¢è½æŠ½é¸
            const fallRand = random();
            
            if (fallRand < 1/PROBABILITIES.rushFall) {
                // è»¢è½
                gameState.mode = 'normal';
                addLog('ğŸ“‰ ãƒ©ãƒƒã‚·ãƒ¥è»¢è½...', 'log-normal');
                
                // è»¢è½æ™‚ã‚‚ã‚ªãƒ¼ãƒˆã‚¹ãƒ”ãƒ³åœæ­¢
                stopAutoSpinOnHit();
            }
            // è»¢è½ã—ãªã„å ´åˆã¯ä½•ã‚‚ã›ãšãƒ©ãƒƒã‚·ãƒ¥ç¶™ç¶š
        }
    }

    function handleExtraSpin() {
        const rand = random();
        
        if (rand < PROBABILITIES.extraContinue) {
            // ãƒ©ãƒƒã‚·ãƒ¥ã«æˆ»ã‚‹
            gameState.mode = 'rush';
            gameState.rushMode = selectRushModeAfterHit(); // é€šå¸¸æŒ¯ã‚Šåˆ†ã‘
            addLog('ğŸ”„ ãƒ©ãƒƒã‚·ãƒ¥ã«å¾©å¸°ï¼', 'log-rush');
        } else {
            // 3000ç™ºä¸Šä¹—ã› + ã‚¨ã‚¯ã‚¹ãƒˆãƒ©ç¶™ç¶š
            gameState.totalBalls += 3000;
            gameState.extraStack++;
            addLog('ğŸ° 3000ç™ºä¸Šä¹—ã›ï¼ã‚¨ã‚¯ã‚¹ãƒˆãƒ©ç¶™ç¶šï¼', 'log-extra');
            
            // ä¸Šä¹—ã›æ™‚ã‚‚ã‚ªãƒ¼ãƒˆã‚¹ãƒ”ãƒ³åœæ­¢
            stopAutoSpinOnHit();
        }
    }

    // ã‚ªãƒ¼ãƒˆã‚¹ãƒ”ãƒ³åœæ­¢æ©Ÿèƒ½
    function stopAutoSpinOnHit() {
        if (gameState.autoSpinInterval) {
            document.getElementById('autospin').checked = false;
            stopAutoSpin();
            addLog('â¸ï¸ å¤§å½“ãŸã‚Š/ãƒãƒ£ãƒ¼ã‚¸ã«ã‚ˆã‚Šã‚ªãƒ¼ãƒˆã‚¹ãƒ”ãƒ³åœæ­¢', 'log-normal');
        }
    }

    function selectRushMode() {
        // ãƒ©ãƒƒã‚·ãƒ¥çªå…¥æ™‚ã¯é’ãƒ¢ãƒ¼ãƒ‰ç¢ºå®šï¼ˆè»¢è½ã‹ã‚‰ã®å¾©å¸°å«ã‚€ï¼‰
        return 'blue';
    }
    
    function selectRushModeAfterHit() {
        // ãƒ©ãƒƒã‚·ãƒ¥ä¸­ã®å½“ãŸã‚Šå¾Œã®ç¶™ç¶šæ™‚ã¯é€šå¸¸æŒ¯ã‚Šåˆ†ã‘
        const rand = random();
        if (rand < RUSH_MODE_DISTRIBUTION.white) return 'white';
        if (rand < RUSH_MODE_DISTRIBUTION.white + RUSH_MODE_DISTRIBUTION.green) return 'green';
        return 'blue';
    }

    function spin10() {
        for (let i = 0; i < 10; i++) {
            spinOnce();
        }
    }

    function spin100() {
        for (let i = 0; i < 100; i++) {
            spinOnce();
        }
    }

    function updateDisplay() {
        document.getElementById('totalSpins').textContent = gameState.totalSpins;
        document.getElementById('totalBalls').textContent = gameState.totalBalls + 'ç™º';
        document.getElementById('hitCount').textContent = gameState.hitCount + 'å›';
        document.getElementById('rushCount').textContent = gameState.rushCount + 'å›';
        
        // å½“ãŸã‚Šå±¥æ­´è¡¨ç¤ºï¼ˆæœ€æ–°5ä»¶ï¼‰
        const historyDisplay = document.getElementById('hitHistoryDisplay');
        if (gameState.hitHistory.length === 0) {
            historyDisplay.innerHTML = 'å±¥æ­´ãªã—';
        } else {
            const recentHistory = gameState.hitHistory.slice(-5).reverse();
            historyDisplay.innerHTML = recentHistory.map((hit, index) => {
                const num = gameState.hitHistory.length - index;
                return `<div style="margin: 5px 0; padding: 5px; background: rgba(0,255,136,0.1); border-radius: 5px;">
                    ${num}. ${hit.type} - ${hit.spins}å›è»¢
                </div>`;
            }).join('');
        }
        
        // æŠ•å…¥ç‰æ•°è¨ˆç®—ï¼ˆé€šå¸¸æ™‚15ç‰ã€ãƒ©ãƒƒã‚·ãƒ¥ãƒ»ã‚¨ã‚¯ã‚¹ãƒˆãƒ©æ™‚1ç‰ï¼‰
        // å±¥æ­´ã®åˆè¨ˆå›è»¢æ•° + ç¾åœ¨ã®å›è»¢æ•°ã§è¨ˆç®—
        const totalAllSpins = gameState.hitHistory.reduce((sum, hit) => sum + hit.spins, 0) + gameState.totalSpins;
        let totalInvestment = 0;
        if (gameState.mode === 'rush' || gameState.mode === 'extra') {
            totalInvestment = totalAllSpins * 1; // ãƒ©ãƒƒã‚·ãƒ¥ä¸­ã¯1ç‰
        } else {
            totalInvestment = totalAllSpins * 15; // é€šå¸¸æ™‚ã¯15ç‰
        }
        
        const balance = gameState.totalBalls - totalInvestment;
        document.getElementById('balance').textContent = balance + 'ç™º';
        
        const payoutRate = totalInvestment > 0 ? 
            ((gameState.totalBalls / totalInvestment) * 100).toFixed(1) : 0;
        document.getElementById('payoutRate').textContent = payoutRate + '%';

        // ãƒ¢ãƒ¼ãƒ‰è¡¨ç¤ºæ›´æ–°
        const modeElement = document.getElementById('currentMode');
        const rushDisplay = document.getElementById('rushModeDisplay');
        
        switch(gameState.mode) {
            case 'normal':
                modeElement.textContent = 'é€šå¸¸ãƒ¢ãƒ¼ãƒ‰';
                modeElement.className = 'mode-indicator mode-normal';
                rushDisplay.style.display = 'none';
                break;
            case 'charge':
                modeElement.textContent = 'ç‚ç‚ãƒãƒ£ãƒ¼ã‚¸';
                modeElement.className = 'mode-indicator mode-charge';
                rushDisplay.style.display = 'none';
                break;
            case 'breath':
                modeElement.textContent = 'å‘½ã®å‘¼å¸ãƒãƒ£ãƒ¬ãƒ³ã‚¸';
                modeElement.className = 'mode-indicator mode-breath';
                rushDisplay.style.display = 'none';
                break;
            case 'rush':
                modeElement.textContent = `ãƒ©ãƒƒã‚·ãƒ¥ãƒ¢ãƒ¼ãƒ‰ (${gameState.rushMode})`;
                modeElement.className = 'mode-indicator mode-rush';
                rushDisplay.style.display = 'grid';
                break;
            case 'extra':
                modeElement.textContent = 'ã‚¨ã‚¯ã‚¹ãƒˆãƒ©ãƒ¢ãƒ¼ãƒ‰';
                modeElement.className = 'mode-indicator mode-extra';
                rushDisplay.style.display = 'none';
                break;
        }
    } gameState.totalBalls + 'ç™º';
        document.getElementById('hitCount').textContent = gameState.hitCount + 'å›';
        document.getElementById('rushCount').textContent = gameState.rushCount + 'å›';
        
        // æŠ•å…¥ç‰æ•°è¨ˆç®—ï¼ˆé€šå¸¸æ™‚15ç‰ã€ãƒ©ãƒƒã‚·ãƒ¥ãƒ»ã‚¨ã‚¯ã‚¹ãƒˆãƒ©æ™‚1ç‰ï¼‰
        let totalInvestment = 0;
        // ç°¡æ˜“è¨ˆç®—ã¨ã—ã¦ã€ç¾åœ¨ã®ãƒ¢ãƒ¼ãƒ‰ã§å…¨å›è»¢è¨ˆç®—ï¼ˆå®Ÿéš›ã¯ãƒ¢ãƒ¼ãƒ‰åˆ¥ã«è¨ˆç®—ã™ã¹ãã ãŒè¤‡é›‘ã«ãªã‚‹ãŸã‚ï¼‰
        if (gameState.mode === 'rush' || gameState.mode === 'extra') {
            totalInvestment = gameState.totalSpins * 1; // ãƒ©ãƒƒã‚·ãƒ¥ä¸­ã¯1ç‰
        } else {
            totalInvestment = gameState.totalSpins * 15; // é€šå¸¸æ™‚ã¯15ç‰
        }
        
        const balance = gameState.totalBalls - totalInvestment;
        document.getElementById('balance').textContent = balance + 'ç™º';
        
        const payoutRate = totalInvestment > 0 ? 
            ((gameState.totalBalls / totalInvestment) * 100).toFixed(1) : 0;
        document.getElementById('payoutRate').textContent = payoutRate + '%';

        // ãƒ¢ãƒ¼ãƒ‰è¡¨ç¤ºæ›´æ–°
        const modeElement = document.getElementById('currentMode');
        const rushDisplay = document.getElementById('rushModeDisplay');
        
        switch(gameState.mode) {
            case 'normal':
                modeElement.textContent = 'é€šå¸¸ãƒ¢ãƒ¼ãƒ‰';
                modeElement.className = 'mode-indicator mode-normal';
                rushDisplay.style.display = 'none';
                break;
            case 'charge':
                modeElement.textContent = 'ç‚ç‚ãƒãƒ£ãƒ¼ã‚¸';
                modeElement.className = 'mode-indicator mode-charge';
                rushDisplay.style.display = 'none';
                break;
            case 'breath':
                modeElement.textContent = 'å‘½ã®å‘¼å¸ãƒãƒ£ãƒ¬ãƒ³ã‚¸';
                modeElement.className = 'mode-indicator mode-breath';
                rushDisplay.style.display = 'none';
                break;
            case 'rush':
                modeElement.textContent = `ãƒ©ãƒƒã‚·ãƒ¥ãƒ¢ãƒ¼ãƒ‰ (${gameState.rushMode})`;
                modeElement.className = 'mode-indicator mode-rush';
                rushDisplay.style.display = 'grid';
                break;
            case 'extra':
                modeElement.textContent = 'ã‚¨ã‚¯ã‚¹ãƒˆãƒ©ãƒ¢ãƒ¼ãƒ‰';
                modeElement.className = 'mode-indicator mode-extra';
                rushDisplay.style.display = 'none';
                break;
        }
    }

    function addLog(message, className = 'log-normal') {
        const log = document.getElementById('gameLog');
        const entry = document.createElement('div');
        entry.className = `log-entry ${className}`;
        entry.textContent = `[${gameState.totalSpins}G] ${message}`;
        log.appendChild(entry);
        log.scrollTop = log.scrollHeight;
        
        // ãƒ­ã‚°ãŒå¤šã™ãã‚‹å ´åˆã¯å¤ã„ã‚‚ã®ã‚’å‰Šé™¤
        if (log.children.length > 100) {
            log.removeChild(log.firstChild);
        }
    }

    function resetGame() {
        gameState = {
            mode: 'normal',
            totalSpins: 0,
            currentSpins: 0,
            totalBalls: 0,
            hitCount: 0,
            rushCount: 0,
            rushMode: 'white',
            extraStack: 0,
            isAutoSpin: false,
            autoSpinInterval: null,
            hitHistory: []
        };
        
        document.getElementById('gameLog').innerHTML = '';
        updateDisplay();
        addLog('ğŸ® ã‚²ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ', 'log-normal');
    }

    // ã‚ªãƒ¼ãƒˆã‚¹ãƒ”ãƒ³æ©Ÿèƒ½
    document.getElementById('autospin').addEventListener('change', function() {
        if (this.checked) {
            startAutoSpin();
        } else {
            stopAutoSpin();
        }
    });

    function startAutoSpin() {
        if (gameState.autoSpinInterval) return;
        
        const speed = parseInt(document.getElementById('autoSpeed').value);
        gameState.autoSpinInterval = setInterval(() => {
            spinOnce();
        }, speed);
        
        // ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
        document.getElementById('spinButton').disabled = true;
        document.getElementById('spin10Button').disabled = true;
        document.getElementById('spin100Button').disabled = true;
    }

    function stopAutoSpin() {
        if (gameState.autoSpinInterval) {
            clearInterval(gameState.autoSpinInterval);
            gameState.autoSpinInterval = null;
        }
        
        // ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
        document.getElementById('spinButton').disabled = false;
        document.getElementById('spin10Button').disabled = false;
        document.getElementById('spin100Button').disabled = false;
    }

    // åˆæœŸåŒ–
    updateDisplay();
    addLog('ğŸ® ç‚ç‚ãƒæ¶ˆé˜²éšŠãƒ‘ãƒãƒ³ã‚³ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼é–‹å§‹ï¼', 'log-normal');
</script>
```

</body>
</html>
